<div class="container-xxl mt-5 mb-5">
  <div class="row">
    <div class="col-8">
      <h1>掲載店舗様店舗管理</h1>
    </div>
    <div class="col">
      <%= link_to "ログアウト", shop_logout_path, data: { turbo_method: :delete, turbo_confirm: "本当にログアウトしますか？" } %>
    </div>
    <% jobs = Sidekiq::ScheduledSet.new %>
    <% jobs.each do |job| %>
      <%= job.jid %>
      <%= job.args.first %>
      <%= job.item["class"] %>
      <br><br>
    <% end %>
    <%= @shop.vacant_job_id %>
    <% unless @shop.vacant_until %>
      <%= form_with url: set_vacant_admin_shop_shop_path(@shop), method: :patch, remote: true, id: "vacant_form" do |form| %>
        <div class="form-group">
          <%= form.label :vacant_time, "空席にする時間を選択してください" %>
          <%= form.select :vacant_time, options_for_select([1, 2, 3]), { prompt: '時間を選択' }, class: "form-control" %>
        </div>
        <%= form.submit "空席にする", class: "btn btn-primary" %>
      <% end %>
    <% else %>
      <p><%= @shop.vacant_until %>まで空席と表示されています。</p>
      <%= form_with url: remove_vacant_admin_shop_shop_path(@shop), method: :delete, remote: true, id: "vacant_form" do |form| %>
        <%= form.submit "今すぐ空席を解除する", class: "btn btn-danger" %>
      <% end %>
    <% end %>
    <%= link_to "店舗編集", admin_shop_shopedit_path %><br>
    <%= link_to "休日管理",  admin_shop_holidays_path %>
    <%= link_to "お知らせ登録",  admin_shop_notices_path %>
  </div>

  <%= month_calendar do |date| %>
    <div class="day">
      <%= date.day %>
      <% if @holidays.include?(date) %>
        <div class="holiday">休</div>
      <% end %>

      <% notices_on_date = @notices.select { |notice| notice.date == date } %>
      <% notices_on_date.each do |notice| %>
        <div class="notice">
          <%= image_tag notice.image.to_s if notice.image? %>
          <%#= link_to notice.title, shop_notice_path(@shop, notice) %>
        </div>
      <% end %>
    </div>
  <% end %>
</div>


<style>
.day {
  position: relative;
}

.holiday {
  background-color: #f8d7da; /* 定休日の色 */
  color: #721c24;
  padding: 2px 4px;
  border-radius: 4px;
  font-size: 0.9em;
}

.notice {
  background-color: #d4edda; /* お知らせの色 */
  color: #155724;
  padding: 2px 4px;
  border-radius: 4px;
  font-size: 0.9em;
}


.notice img {
  max-width: 100px;
  height: auto;
  display: block;
}
</style>
